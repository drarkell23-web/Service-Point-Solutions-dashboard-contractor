<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>ServicePoint SA ‚Äì Contractor HQ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body class="theme-dark">
  <!-- TOP BAR -->
  <header class="sp-topbar">
    <div class="sp-brand">
      <div class="sp-brand-logo">S</div>
      <div class="sp-brand-text">
        <div class="sp-brand-name">ServicePoint SA</div>
        <div class="sp-brand-sub">Contractor HQ ¬∑ Live SaaS dashboard</div>
      </div>
    </div>

    <div class="sp-topbar-center">
      <div class="sp-top-pill">
        All your ServicePoint leads, jobs & billing in one live hub.
      </div>
      <div class="sp-top-filters">
        <label class="sp-filter">
          Range
          <select id="filterRange">
            <option value="30">Last 30 days</option>
            <option value="7">Last 7 days</option>
            <option value="90">Last 90 days</option>
            <option value="all">All time</option>
          </select>
        </label>
        <label class="sp-filter">
          Region
          <select id="filterRegion">
            <option value="all">All regions</option>
            <option value="KZN">KZN</option>
            <option value="Gauteng">Gauteng</option>
            <option value="Western Cape">Western Cape</option>
            <option value="Other">Other / Unassigned</option>
          </select>
        </label>
      </div>
    </div>

    <div class="sp-topbar-right">
      <button id="btnNewLeadHeader" class="primary-btn">+ New lead</button>
      <button id="themeToggle" class="ghost-btn">Toggle theme</button>
    </div>
  </header>

  <main class="sp-layout">
    <!-- SIDEBAR -->
    <aside class="sp-sidebar">
      <nav class="sp-nav">
        <button class="sp-nav-item active" data-view-target="overview">
          <span class="sp-nav-icon">üìä</span>
          <span>Overview</span>
        </button>
        <button class="sp-nav-item" data-view-target="leads">
          <span class="sp-nav-icon">üßæ</span>
          <span>Leads</span>
        </button>
        <button class="sp-nav-item" data-view-target="jobs">
          <span class="sp-nav-icon">üß∞</span>
          <span>Jobs</span>
        </button>
        <button class="sp-nav-item" data-view-target="billing">
          <span class="sp-nav-icon">üí∏</span>
          <span>Billing</span>
        </button>
        <button class="sp-nav-item" data-view-target="settings">
          <span class="sp-nav-icon">‚öôÔ∏è</span>
          <span>Settings</span>
        </button>
      </nav>

      <div class="sp-sidebar-foot">
        <div class="sp-foot-label">Account</div>
        <div class="sp-foot-line">Contractor: <strong>ServicePoint Network</strong></div>
        <div class="sp-foot-line">Live source: Admin ‚Üí this dashboard</div>
        <div class="sp-foot-line">
          Support:
          <a href="mailto:servicepoint.info@gmail.com">servicepoint.info@gmail.com</a>
        </div>
      </div>
    </aside>

    <!-- MAIN -->
    <section class="sp-main">
      <!-- OVERVIEW VIEW -->
      <section class="sp-view sp-view--active" data-view="overview">
        <header class="sp-view-header">
          <h1>Live operations overview</h1>
          <p>Real-time snapshot of your ServicePoint leads, jobs and billing.</p>
        </header>

        <!-- KPIs -->
        <section class="sp-grid-4 sp-kpis">
          <article class="sp-card sp-card-kpi">
            <div class="sp-kpi-label">New leads (selected range)</div>
            <div id="kpiLeads" class="sp-kpi-value">0</div>
            <div class="sp-kpi-foot">From ServicePoint + assistant in filter window.</div>
          </article>

          <article class="sp-card sp-card-kpi">
            <div class="sp-kpi-label">Active jobs</div>
            <div id="kpiActiveJobs" class="sp-kpi-value">0</div>
            <div class="sp-kpi-foot">Jobs not yet completed or cancelled.</div>
          </article>

          <article class="sp-card sp-card-kpi">
            <div class="sp-kpi-label">Pipeline value</div>
            <div id="kpiPipeline" class="sp-kpi-value">R0</div>
            <div class="sp-kpi-foot">Quoted + booked + in progress work.</div>
          </article>

          <article class="sp-card sp-card-kpi">
            <div class="sp-kpi-label">Paid this month</div>
            <div id="kpiPaid" class="sp-kpi-value">R0</div>
            <div class="sp-kpi-foot">Based on invoices you mark as paid.</div>
          </article>
        </section>

        <!-- CHARTS + ACTIVITY -->
        <section class="sp-grid-main-side sp-mt-lg">
          <div class="sp-grid-main">
            <article class="sp-card">
              <header class="sp-panel-header">
                <div>
                  <h2>Leads timeline</h2>
                  <p>How many leads you received per day (in the selected range).</p>
                </div>
              </header>
              <div class="sp-chart-wrap">
                <canvas id="chartLeadsTimeline"></canvas>
                <div id="chartLeadsTimelineEmpty" class="sp-chart-empty">
                  Waiting for your first lead‚Ä¶
                </div>
              </div>
            </article>

            <section class="sp-grid-2 sp-mt-lg">
              <article class="sp-card">
                <header class="sp-panel-header">
                  <div>
                    <h2>Lead sources</h2>
                    <p>Where your work is coming from.</p>
                  </div>
                </header>
                <div class="sp-chart-wrap-small">
                  <canvas id="chartChannelBreakdown"></canvas>
                  <div id="chartChannelEmpty" class="sp-chart-empty small">
                    No leads yet to show channels.
                  </div>
                </div>
              </article>

              <article class="sp-card">
                <header class="sp-panel-header">
                  <div>
                    <h2>Pipeline status</h2>
                    <p>Mix of New, Quoted, Booked, Completed, etc.</p>
                  </div>
                </header>
                <div class="sp-chart-wrap-small">
                  <canvas id="chartStatusBreakdown"></canvas>
                  <div id="chartStatusEmpty" class="sp-chart-empty small">
                    No leads yet to show statuses.
                  </div>
                </div>
              </article>
            </section>
          </div>

          <aside class="sp-grid-side">
            <article class="sp-card sp-card-activity">
              <header class="sp-panel-header">
                <div>
                  <h2>Live activity</h2>
                  <p>Everything that happens in your account.</p>
                </div>
              </header>
              <ul id="activityFeed" class="sp-activity-list">
                <!-- Filled by JS -->
              </ul>
              <div class="sp-activity-empty" id="activityEmpty">
                No activity yet. When admin sends your first lead, it will appear here.
              </div>
            </article>

            <article class="sp-card sp-card-mini sp-mt-sm">
              <header class="sp-panel-header">
                <div>
                  <h2>Today‚Äôs quick snapshot</h2>
                  <p>Only counts items for today.</p>
                </div>
              </header>
              <dl class="sp-mini-metrics">
                <div>
                  <dt>Leads today</dt>
                  <dd id="miniLeadsToday">0</dd>
                </div>
                <div>
                  <dt>Jobs on site today</dt>
                  <dd id="miniJobsToday">0</dd>
                </div>
                <div>
                  <dt>Value of work on site</dt>
                  <dd id="miniValueToday">R0</dd>
                </div>
              </dl>
            </article>
          </aside>
        </section>

        <!-- RECENT LEADS TABLE PREVIEW -->
        <section class="sp-card sp-mt-lg">
          <header class="sp-panel-header sp-panel-header-inline">
            <div>
              <h2>Recent leads (live)</h2>
              <p>Last 10 leads across all channels.</p>
            </div>
            <button class="ghost-btn" data-open-view="leads">Open full leads table ‚Üí</button>
          </header>
          <table class="sp-table">
            <thead>
              <tr>
                <th>Received</th>
                <th>Client</th>
                <th>Service</th>
                <th>Channel</th>
                <th>Status</th>
                <th>Value</th>
              </tr>
            </thead>
            <tbody id="overviewLeadsBody">
              <!-- Filled by JS -->
            </tbody>
          </table>
          <div id="overviewLeadsEmpty" class="sp-table-empty">
            No leads yet. They will appear here as soon as admin sends them to you.
          </div>
        </section>
      </section>

      <!-- LEADS VIEW -->
      <section class="sp-view" data-view="leads">
        <header class="sp-view-header sp-view-header-inline">
          <div>
            <h1>Leads & clients</h1>
            <p>Every lead that comes from ServicePoint, WhatsApp, phone, or your assistant.</p>
          </div>
          <button id="btnNewLeadLeadsView" class="primary-btn">+ New lead</button>
        </header>

        <section class="sp-card sp-mt-sm">
          <div class="sp-leads-toolbar">
            <div class="sp-leads-filters">
              <input
                type="text"
                id="leadsSearch"
                class="sp-input"
                placeholder="Search by client, service or channel‚Ä¶"
              />
              <select id="leadsStatusFilter" class="sp-input">
                <option value="all">All statuses</option>
                <option value="New">New</option>
                <option value="Contacted">Contacted</option>
                <option value="Quoted">Quoted</option>
                <option value="Booked">Booked</option>
                <option value="In progress">In progress</option>
                <option value="Completed">Completed</option>
                <option value="Lost">Lost</option>
              </select>
              <select id="leadsChannelFilter" class="sp-input">
                <option value="all">All channels</option>
                <option value="ServicePoint SA">ServicePoint SA</option>
                <option value="WhatsApp">WhatsApp</option>
                <option value="Phone">Phone</option>
                <option value="Email">Email</option>
                <option value="Walk-in">Walk-in</option>
                <option value="Other">Other</option>
              </select>
            </div>
            <span class="sp-leads-count">
              <span id="leadsCount">0</span> lead(s)
            </span>
          </div>

          <table class="sp-table sp-table-leads">
            <thead>
              <tr>
                <th>Received</th>
                <th>Client</th>
                <th>Service</th>
                <th>Channel</th>
                <th>Region</th>
                <th>Status</th>
                <th>Value</th>
              </tr>
            </thead>
            <tbody id="leadsTableBody">
              <!-- Filled by JS -->
            </tbody>
          </table>
          <div id="leadsEmptyState" class="sp-table-empty">
            No leads yet. Once you or admin add a lead, it will show here.
          </div>
        </section>
      </section>

      <!-- JOBS VIEW -->
      <section class="sp-view" data-view="jobs">
        <header class="sp-view-header sp-view-header-inline">
          <div>
            <h1>Jobs & schedule</h1>
            <p>Site work created from your leads and clients.</p>
          </div>
          <button id="btnNewJob" class="primary-btn">+ New job</button>
        </header>

        <section class="sp-card sp-mt-sm">
          <header class="sp-panel-header">
            <div>
              <h2>Upcoming & active jobs</h2>
              <p>Jobs in the next 60 days and in progress.</p>
            </div>
          </header>

          <table class="sp-table">
            <thead>
              <tr>
                <th>Date</th>
                <th>Job</th>
                <th>Client</th>
                <th>Location</th>
                <th>Status</th>
                <th>Value</th>
              </tr>
            </thead>
            <tbody id="jobsTableBody">
              <!-- Filled by JS -->
            </tbody>
          </table>
          <div id="jobsEmptyState" class="sp-table-empty">
            No jobs yet. Convert a lead into a job or create one manually.
          </div>
        </section>
      </section>

      <!-- BILLING VIEW -->
      <section class="sp-view" data-view="billing">
        <header class="sp-view-header sp-view-header-inline">
          <div>
            <h1>Billing & invoices</h1>
            <p>Simple overview for your own accounting system.</p>
          </div>
          <button id="btnNewInvoice" class="primary-btn">+ Add invoice</button>
        </header>

        <section class="sp-grid-3 sp-mt-sm">
          <article class="sp-card sp-card-kpi">
            <div class="sp-kpi-label">Invoiced (selected range)</div>
            <div id="billInvoiced" class="sp-kpi-value">R0</div>
            <div class="sp-kpi-foot">All invoices in the date filter.</div>
          </article>
          <article class="sp-card sp-card-kpi">
            <div class="sp-kpi-label">Paid</div>
            <div id="billPaid" class="sp-kpi-value">R0</div>
            <div class="sp-kpi-foot">Invoices marked as paid.</div>
          </article>
          <article class="sp-card sp-card-kpi">
            <div class="sp-kpi-label">Outstanding</div>
            <div id="billOutstanding" class="sp-kpi-value">R0</div>
            <div class="sp-kpi-foot">Invoiced ‚Äì paid.</div>
          </article>
        </section>

        <section class="sp-card sp-mt-lg">
          <header class="sp-panel-header">
            <div>
              <h2>Invoices log</h2>
              <p>Use this as a quick reference next to your accounting system.</p>
            </div>
          </header>

          <table class="sp-table">
            <thead>
              <tr>
                <th>Date</th>
                <th>Invoice #</th>
                <th>Client</th>
                <th>Amount</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody id="invoicesTableBody">
              <!-- Filled by JS -->
            </tbody>
          </table>
          <div id="invoicesEmptyState" class="sp-table-empty">
            No invoices yet. Add them as you bill clients.
          </div>
        </section>
      </section>

      <!-- SETTINGS VIEW -->
      <section class="sp-view" data-view="settings">
        <header class="sp-view-header">
          <h1>Settings</h1>
          <p>These are front-end only toggles ‚Äì backend logic can come later.</p>
        </header>

        <section class="sp-card sp-mt-sm sp-settings-grid">
          <div class="sp-settings-block">
            <h2>Notification preferences</h2>
            <label class="sp-toggle">
              <input type="checkbox" checked />
              <span></span>
              Email me when a new lead arrives
            </label>
            <label class="sp-toggle">
              <input type="checkbox" checked />
              <span></span>
              Email me when a job is booked
            </label>
            <label class="sp-toggle">
              <input type="checkbox" />
              <span></span>
              Email me when an invoice is overdue
            </label>
          </div>

          <div class="sp-settings-block">
            <h2>Connected channels</h2>
            <ul class="sp-settings-list">
              <li>
                <span>ServicePoint SA</span>
                <span class="sp-tag sp-tag-live">Connected</span>
              </li>
              <li>
                <span>WhatsApp assistant</span>
                <span class="sp-tag sp-tag-live">Connected</span>
              </li>
              <li>
                <span>Manual capture</span>
                <span class="sp-tag">Always available</span>
              </li>
            </ul>
          </div>

          <div class="sp-settings-block">
            <h2>API hooks (frontend only)</h2>
            <p class="sp-settings-note">
              Admin or another site can push into this dashboard using:
            </p>
            <pre class="sp-code">
window.addServicePointLead({...})
window.addServicePointJob({...})
window.addServicePointInvoice({...})</pre>
            <p class="sp-settings-note small">
              Later you can connect this to Supabase or another backend ‚Äì the
              structure is already ready.
            </p>
          </div>
        </section>
      </section>
    </section>
  </main>

  <footer class="sp-footer">
    <span>¬© 2025 ServicePoint SA ¬∑ Contractor HQ</span>
    <span>Live data only ‚Äì everything here updates as leads come in from admin.</span>
  </footer>

  <!-- MODALS -->

  <!-- NEW LEAD MODAL -->
  <div id="leadModal" class="sp-modal-bg">
    <div class="sp-modal">
      <header class="sp-modal-header">
        <h2>New lead</h2>
        <button class="sp-modal-close" data-modal-close="leadModal">‚úï</button>
      </header>
      <p class="sp-modal-sub">
        Quick capture for a new lead from ServicePoint, WhatsApp, phone or walk-in.
      </p>

      <form id="leadForm" class="sp-form">
        <label class="sp-field">
          <span>Client name</span>
          <input id="leadClient" type="text" class="sp-input" required />
        </label>

        <label class="sp-field">
          <span>Service requested</span>
          <input
            id="leadService"
            type="text"
            class="sp-input"
            placeholder="e.g. Geyser replacement ‚Äì Pinetown"
            required
          />
        </label>

        <div class="sp-form-grid-3">
          <label class="sp-field">
            <span>Channel</span>
            <select id="leadChannel" class="sp-input">
              <option value="ServicePoint SA">ServicePoint SA</option>
              <option value="WhatsApp">WhatsApp</option>
              <option value="Phone">Phone</option>
              <option value="Email">Email</option>
              <option value="Walk-in">Walk-in</option>
              <option value="Other">Other</option>
            </select>
          </label>

          <label class="sp-field">
            <span>Region</span>
            <select id="leadRegion" class="sp-input">
              <option value="KZN">KZN</option>
              <option value="Gauteng">Gauteng</option>
              <option value="Western Cape">Western Cape</option>
              <option value="Other">Other / Unassigned</option>
            </select>
          </label>

          <label class="sp-field">
            <span>Status</span>
            <select id="leadStatus" class="sp-input">
              <option value="New">New</option>
              <option value="Contacted">Contacted</option>
              <option value="Quoted">Quoted</option>
              <option value="Booked">Booked</option>
              <option value="In progress">In progress</option>
              <option value="Completed">Completed</option>
              <option value="Lost">Lost</option>
            </select>
          </label>
        </div>

        <label class="sp-field">
          <span>Estimated value (R)</span>
          <input
            id="leadValue"
            type="number"
            min="0"
            step="1"
            class="sp-input"
            placeholder="e.g. 2500"
          />
        </label>

        <div class="sp-modal-actions">
          <button
            type="button"
            class="ghost-btn"
            data-modal-close="leadModal"
          >
            Cancel
          </button>
          <button type="submit" class="primary-btn">Save lead</button>
        </div>
      </form>
    </div>
  </div>

  <!-- NEW JOB MODAL -->
  <div id="jobModal" class="sp-modal-bg">
    <div class="sp-modal">
      <header class="sp-modal-header">
        <h2>New job</h2>
        <button class="sp-modal-close" data-modal-close="jobModal">‚úï</button>
      </header>
      <p class="sp-modal-sub">
        Create a job from a confirmed client or lead. You can link it to a lead later.
      </p>

      <form id="jobForm" class="sp-form">
        <div class="sp-form-grid-2">
          <label class="sp-field">
            <span>Date</span>
            <input id="jobDate" type="date" class="sp-input" required />
          </label>
          <label class="sp-field">
            <span>Client name</span>
            <input id="jobClient" type="text" class="sp-input" required />
          </label>
        </div>

        <label class="sp-field">
          <span>Job description</span>
          <input
            id="jobTitle"
            type="text"
            class="sp-input"
            placeholder="e.g. Geyser replacement ‚Äì Pinetown"
            required
          />
        </label>

        <div class="sp-form-grid-3">
          <label class="sp-field">
            <span>Location</span>
            <input
              id="jobLocation"
              type="text"
              class="sp-input"
              placeholder="e.g. Pinetown"
            />
          </label>
          <label class="sp-field">
            <span>Status</span>
            <select id="jobStatus" class="sp-input">
              <option value="Booked">Booked</option>
              <option value="On site">On site</option>
              <option value="In progress">In progress</option>
              <option value="Completed">Completed</option>
              <option value="Cancelled">Cancelled</option>
            </select>
          </label>
          <label class="sp-field">
            <span>Job value (R)</span>
            <input
              id="jobValue"
              type="number"
              min="0"
              step="1"
              class="sp-input"
            />
          </label>
        </div>

        <div class="sp-modal-actions">
          <button
            type="button"
            class="ghost-btn"
            data-modal-close="jobModal"
          >
            Cancel
          </button>
          <button type="submit" class="primary-btn">Save job</button>
        </div>
      </form>
    </div>
  </div>

  <!-- NEW INVOICE MODAL -->
  <div id="invoiceModal" class="sp-modal-bg">
    <div class="sp-modal">
      <header class="sp-modal-header">
        <h2>New invoice</h2>
        <button class="sp-modal-close" data-modal-close="invoiceModal">‚úï</button>
      </header>
      <p class="sp-modal-sub">
        Track invoices here while you use your own accounting system.
      </p>

      <form id="invoiceForm" class="sp-form">
        <div class="sp-form-grid-3">
          <label class="sp-field">
            <span>Date</span>
            <input id="invoiceDate" type="date" class="sp-input" required />
          </label>
          <label class="sp-field">
            <span>Invoice #</span>
            <input id="invoiceNumber" type="text" class="sp-input" required />
          </label>
          <label class="sp-field">
            <span>Client</span>
            <input id="invoiceClient" type="text" class="sp-input" required />
          </label>
        </div>

        <div class="sp-form-grid-2">
          <label class="sp-field">
            <span>Amount (R)</span>
            <input
              id="invoiceAmount"
              type="number"
              min="0"
              step="1"
              class="sp-input"
              required
            />
          </label>
          <label class="sp-field">
            <span>Status</span>
            <select id="invoiceStatus" class="sp-input">
              <option value="Sent">Sent</option>
              <option value="Paid">Paid</option>
              <option value="Overdue">Overdue</option>
            </select>
          </label>
        </div>

        <div class="sp-modal-actions">
          <button
            type="button"
            class="ghost-btn"
            data-modal-close="invoiceModal"
          >
            Cancel
          </button>
          <button type="submit" class="primary-btn">Save invoice</button>
        </div>
      </form>
    </div>
  </div>

  <!-- LIBS + APP -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="script.js" defer></script>
</body>
</html>
